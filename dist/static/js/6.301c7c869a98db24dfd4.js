webpackJsonp([6],{PybM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("2hfY"),i=a("QUe6"),o={name:"scheduler",data:function(){return{today:Object(n.b)(new Date),loading:!0,dialogVisiable:!1,dialogStatus:"create",pickerDate:Object(n.b)(new Date),customers:[],schedulerEvents:[],form:{event_id:"",memo:"",name:"",phone:"",hospital:"",bookTime:""},hospitalOptions:[{value:1,label:"世纪口腔"},{value:2,label:"艾雅口腔"},{value:3,label:"诊所3"}],rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],hospital:[{required:!0,message:"不能为空",trigger:"blur"}]}}},computed:{startHour:function(){return 8},stopHour:function(){return 21}},mounted:function(){this.initData()},watch:{form:function(){},pickerDate:function(){this.pickNewDate()}},methods:{resetForm:function(){this.form={event_id:"",memo:"",name:"",phone:"",hospital:"",bookTime:""}},createEvent:function(){var e=this;this.$refs.form.validate(function(t){t&&i.a.createDateEvents(e.form).then(function(t){e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.dialogVisiable=!1,e.fetchEvents(Object(n.b)(e.pickerDate))}).catch(function(e){return console.error(e)})})},updateEvent:function(){var e=this;this.$refs.form.validate(function(t){t&&i.a.updateDateEvent(e.form).then(function(t){e.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3}),e.dialogVisiable=!1,e.fetchEvents(Object(n.b)(e.pickerDate))}).catch(function(e){return console.error(e)})})},handleCreate:function(e,t){var a=this;null===e&&(this.dialogVisiable=!0,this.dialogStatus="create",this.resetForm(),this.form.bookTime=Object(n.b)(this.pickerDate)+" "+t),this.$nextTick(function(){a.$refs.form.clearValidate()})},handleEdit:function(e){var t=this;this.form={event_id:e.id,memo:e.memo,name:e.customer.name,phone:e.customer.phone,bookTime:e.bookTime},this.dialogStatus="update",this.dialogVisiable=!0,this.$nextTick(function(){t.$refs.form.clearValidate()})},pickNewDate:function(){this.loading=!0;var e=Object(n.b)(this.pickerDate);this.fetchEvents(e)},initData:function(){this.fetchEvents(this.today)},generateInitEvents:function(e,t){for(var a=[],n=e;n<=t;n++){var i,o=n;o<10?o="0"+o+":00":o+=":00",i={hour:o,event:null},a.push(i)}return a},fetchEvents:function(e){var t=this;i.a.getDateEvents(e).then(function(e){var a=e.data,n=t.generateInitEvents(t.startHour,t.stopHour);for(var i in a){var o=a[i];n[parseInt(o.bookTime.split(":"))-t.startHour].event=o}t.schedulerEvents=n,t.loading=!1})},customLabel:function(e){return e.phone+" - "+e.name},showToday:function(){this.pickerDate=this.today},previousDay:function(){this.pickerDate=Object(n.a)(this.pickerDate,-1)},nextDay:function(){this.pickerDate=Object(n.a)(this.pickerDate,1)}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-menu",{staticClass:"scheduler-nav",attrs:{mode:"horizontal","text-color":"#fff","background-color":"#409eff"}},[a("div",{staticClass:"date col"},[a("el-date-picker",{attrs:{type:"date",clearable:!1},on:{change:e.pickNewDate},model:{value:e.pickerDate,callback:function(t){e.pickerDate=t},expression:"pickerDate"}})],1),e._v(" "),a("div",{staticClass:"right-menu col"},[a("button",{staticClass:"btn",attrs:{type:"button"},on:{click:e.showToday}},[a("span",[e._v("显示今天")])]),e._v(" "),a("div",{staticClass:"arrow-group"},[a("button",{staticClass:"btn",attrs:{type:"button"},on:{click:e.previousDay}},[e._v(" <")]),e._v(" "),a("button",{staticClass:"btn",attrs:{type:"button"},on:{click:e.nextDay}},[e._v(" >")])])])]),e._v(" "),e.schedulerEvents?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"scheduler-table"},[e._l(e.schedulerEvents,function(t){return[a("el-row",{staticClass:"event-row"},[a("el-col",{staticClass:"event-hour",attrs:{span:1}},[a("span",[e._v(e._s(t.hour))])]),e._v(" "),a("el-col",{staticClass:"event-item",attrs:{span:23}},[a("div",{on:{click:function(a){e.handleCreate(t.event,t.hour)}}},[t.event?a("span",{on:{click:function(a){a.stopPropagation(),e.handleEdit(t.event)}}},[e._v(e._s("患者: "+t.event.customer.name+"    类型: "+t.event.regType+"    大夫: "+t.event.doctor.name+" "))]):e._e()])])],1)]}),e._v(" "),a("el-dialog",{attrs:{title:"预约表格",visible:e.dialogVisiable,width:"30%","close-on-click-modal":!0},on:{"update:visible":function(t){e.dialogVisiable=t},close:function(t){e.dialogVisiable=!1}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left","label-width":"80px",rules:e.rules}},[a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"姓名",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{value:"number"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"开始时间"}},[a("el-row",[a("el-col",{attrs:{span:24}},[e._v(e._s(e.form.bookTime))])],1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"备注"}},[a("el-input",{attrs:{"auto-complete":"off",type:"textarea"},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisiable=!1}}},[e._v("取消")]),e._v(" "),"create"===e.dialogStatus?a("el-button",{attrs:{type:"success"},on:{click:e.createEvent}},[e._v("新建")]):a("el-button",{attrs:{type:"success"},on:{click:e.updateEvent}},[e._v("更改")])],1)],1)],2):e._e()],1)},staticRenderFns:[]};var r={name:"calendar",components:{Scheduler:a("VU/8")(o,s,!1,function(e){a("rWjm")},"data-v-25f5d71d",null).exports}},l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"calendar-container"},[t("scheduler")],1)},staticRenderFns:[]};var c=a("VU/8")(r,l,!1,function(e){a("VYxg")},"data-v-9c5b9116",null);t.default=c.exports},VYxg:function(e,t){},rWjm:function(e,t){}});
//# sourceMappingURL=6.301c7c869a98db24dfd4.js.map